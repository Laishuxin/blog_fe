(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{619:function(t,s,a){"use strict";a.r(s);var e=a(1),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"解决跨域问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决跨域问题"}},[t._v("#")]),t._v(" 解决跨域问题")]),t._v(" "),a("p",[t._v("问题描述：\n我们当前处于 "),a("code",[t._v("http://localhost:3000")]),t._v("，我们要向服务器 "),a("code",[t._v("http://localhost:5000")]),t._v(" 发送请求获取数据。")]),t._v(" "),a("p",[t._v("显然这是一个跨域请求，浏览器会拒绝我们的请求。")]),t._v(" "),a("p",[t._v("为了解决跨域问题，vite 为我们提供了代理的机制，让我们实现跨域发送请求。具体的使用步骤如下：")]),t._v(" "),a("ol",[a("li",[t._v("配置 vite。")]),t._v(" "),a("li",[t._v("重新设置请求 url。")])]),t._v(" "),a("h2",{attrs:{id:"配置-vite"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-vite"}},[t._v("#")]),t._v(" 配置 vite")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://vitejs.cn/config/#server-proxy",target:"_blank",rel:"noopener noreferrer"}},[t._v("vite 官网文档"),a("OutboundLink")],1),t._v("已经很详细描述了配置项。\n这里以其中一个为例，讲解一下各个字段的作用。")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    proxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api1'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        target"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:5000'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        changeOrigin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("rewrite")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("^\\/fallback")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("ol",[a("li",[t._v("target。指向我们要发送的目标服务器的 url。")]),t._v(" "),a("li",[t._v("changeOrigin。是否改变源。例如我们当前在"),a("code",[t._v("http://localhost:3000")]),t._v("，我们配置的 target 为"),a("code",[t._v("http://localhost:5000")]),t._v("如果 changeOrigin 为 false 时，服务器接收到的请求中 origin 将为 "),a("code",[t._v("http://localhost:3000")]),t._v("。如果 changeOrigin 为 true 时，则服务器接收到的请求中，origin 将为 "),a("code",[t._v("http://localhost:5000")]),t._v("，也就是我们的 target。")]),t._v(" "),a("li",[t._v("rewrite。重写请求的 url。")])]),t._v(" "),a("h2",{attrs:{id:"重新设置请求的-url"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重新设置请求的-url"}},[t._v("#")]),t._v(" 重新设置请求的 url")]),t._v(" "),a("p",[t._v("由于设置了代理，所以我们需要修改我们请求的 url，指向代理服务器的 url，也就是 "),a("code",[t._v("http://localhost:3000")]),t._v("。")])])}),[],!1,null,null,null);s.default=r.exports}}]);