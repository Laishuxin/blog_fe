(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{537:function(s,t,n){s.exports=n.p+"assets/img/2021-09-17-23-13-08.eb80b67f.png"},538:function(s,t,n){s.exports=n.p+"assets/img/2021-04-05-20-37-34.2bf8c6a2.png"},539:function(s,t,n){s.exports=n.p+"assets/img/2021-04-05-22-10-20.55f279f3.png"},540:function(s,t){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA/UAAAGqCAIAAADFnvOlAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAB1SSURBVHhe7d29WtvI2wdg/B6LnSJXjgCOANKkSpvOlLj5dynTbQMldNtulSZwBPgIcqWIfS5+9TEykmz8ATZYj++72LVkfUx2M9JP45lRbzabnQAAACH8X/o3AADQffI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfH6jpzVmv1zu7maZlIAq1G4C9ku8BACCO3mw2Sx8BAICO034PAABxyPcAABCHfP86D5e9zOXD/GPuadzc07q0UUP920xjg/YIvGLbYrH8prR4TOCtvLT6PzO+tnFBePr2aeuq7jf2bOy15KgAHB/5fif+Zvfdi7u0cDIeDbK7eX4vflp3cnJ30b4r17/N3F2sz+uTm7PBaJwWNtsF2KsXVP8FeUpvXBDGo2+tHX5d1ut+rsj7rctIdnoP/gDHTr7fhbvR6OR6MitMrk/zNT/Ovo3Gp82V49E/jdvu8L78Nnc/zNfc/Vx5Xx6PLtonWrcLsF8vrP41WU4vU3rtkjC5/lR8VxmPRnfV149X/WzN9CY7Sfbv+Xly6UJyIeEDHDP5fieG9+UdN9O/+je/m4/H48bK78Vt9/ffeYvc+e3s9jx9zpzfFjfm2gbLZHfy9okEfHhfL6j+DQ//5Dk9j+m1S0L/6rbav5R9X79iPO01P08uu64UVxKXBYBjJt/vwvBL/b7b/1A0vDVXDj7mWXxR1aN24Wf2pT59qN/x04mAd/SK6l+Y/v2d/XP4vRnn206/fm58X+7VXps7/7JBUwEAkcn3+3L6cZA+FRayeBoV1+5Ru1LrmMBhWlf96yZ/trgGzJV7NZ/468Z/JukTAEdHvn8XZX/bRr/Z1HEWYL2VPwlkNAYAHDH5/l0UbW/Nn9Yffm7QPweIpkzqdz+2m9iy/Elg2V7lpeT5ln0AwpPv309tPo35/BnAkUnDb8ejQX0KzenN5erAX3azb+1Vzbt7ev2/ev9/AI6LfP8uyltzPn19aTA6ub7WPweOUpo9Kw/r6YqQXxPy8bOrnN9WE28+7VUO0z+9/nf1YF1gvXKUXDHXbBowl3l6nn5at+yVE/VvM0tnrG1s83TgctqNfLmagKP9EF/X+A7m5Pv3Uc1iVxrezx6vPqQF4NhkF4TqjRZJbX7NZ/WvHhcG7uRz5K/fE9jUft5fmaf0xjZeaceOpcGdAACU5s/O87kw0kP46Wn2r/bK4tk6yfasLVUHelo1f5ivbTW5HqYjPj3q1w/ytL4xNUdVyOamMNN+DwCw1O7fX+mVdrwB+R4AYJndv7/SK+14C/I9AMCmXvf+Sq+04y3I9wAAOzHdz/srvdKO7cj3AAA7sfb9lV5px1uQ7wEAdmfV+yu90o63IN8DAOzEBu+v9Eo79k++BwDYjU3eX+mVduxbbzabpY8AAEDHab8HAIA45HsAAIhDvgcAgDjkewAAiEO+BwCAOMyfAwAs0ev10idgmYNN0drvAQAgDu33wF5o+YPVDv/+qxbDatrvAQCAvZPvAQAgjt33z/FzHqx2JJ3iXApgtc71zzmSaxes0JVKof0eAADi0H4Pb+042++1/EHnKoVaDC3a7wEAgLcm3wMAQBx775/j5zw4zkrhUgAtnasUajG0dKVSaL8HAIA45HsAAIhDvgcAgDjkewAAiEO+BwCAOOR7AACIQ74HAIA45HsAAIhDvgcAOuXhstfrnd1M0+Iy05uzxjYb7JIptupdPqRF6Cj5HgDgfZTPIXMeLdgJ+R4AiKZ/9TibzR6v+mn5EOXZfjAap6XC3YWMzw7I9wAAb276678s2w/vs+eQ5H6Yr7/7sa4bEawh3wMAvL0P3yez2e15Wsqc306uT09Oxv/9EvB5FfkeADhM5XjXZNno2Hr39cb37fG1SzU6vz9/+PybatP6VitK9zSct36OZs+b/vn5IfceosvkewDg8OQR+eIuLeTGo2/NCD65Oat3Xx+PBlt0Xc9zd6Pze7b72Y/faaHl12Wrn/yy0g0We863Snh3sa5z/eRPvvWnD4I/ryLfAwAHJkvfZXqudU+fXH8qvkvGo4vRyfWk+u40X7dx1/Xpzbcid59WBygOMR43Q3wyHo3uqnKUI3YfLovS1QpXdJ1vnX5pCX+uCPjlYU+v/1frswMvIN8DAIfl4Z88fefhu9Y9vX9125wOZ3g/nx+nf/VvkZ/HfyblitXmx69NsNO/eizHty7KNqx3k5/e/MhieBbuayvPb/OdWz3n6yeoSvhcwM9/T8jTfe0PBS8l3wMAB2X6N+8nM/y+OugOv9SbufsfGq37K5XHP/36uXX88y9LA357w7ITTT6VZV3Rot98vmj2s3m+hFVfodYDDbyUfA8AHJQyQK9x+nGQPm3tjXq5b1TCKtvnfX203LMj8j0AwLZqne9rtmt+f7jMs33ebK/dnl2S7wGAgzL4WPRU39t7ntLxF3rCP/zM+9isVe7+++8rS1eOIc4eEzTbs2vyPQBwUPpX3/OO8PmMlbWIP7253FHg73/+WgT8xnSVD5fNCS+fV+7eKl2+f3MO/DWKMb7mymEv5PtN5TPdrpu2dnO7PRoAhFJOR1OE6GLwam4wemZ2+u1Vk9nUB8nmbenDZybQaal2r5du04eDSjnGt3GEGgmBV5HvN1TWw13Z7dEAIJrz2/mc8clOZ47sXz2Wc9ZXirlrvqSFtfLdm6XT0YYD0pvNZunjjmRPnelTYefHfyfT4hV0zcluX263R+PQBa0UaxznnxpW6FylUIuhpSuVQvt9Uz5N1Vz561i5Kovj2ef0O16tg13R0eZJ8we1ctd86+q4Z5eXq44GAACvIt8/yTN4GbyTu4s1/d8Wx+I0x+pUfl02jgsAAHsi389Nf/2XZ/DafLZlx7y8j13VBzB9WetgV9s8bb8w39Z4NLqrNnu8vV11NAAAeBX5vqX+srnz2zXd489vGx3o02j/hRlxT68n+tkDAPAW5Pu5+XS2vW3npXrqtL90cqzTr5810AMA8Cbk+ye1ya7Kka9rU34aXKtzPQAAB0K+byo726eu9MsHy1amxXul8/lynzSm0gUAgLcm3y93flu25C/0pX8y+TNu9715+Lndy+sAAGC35Pu5h8vGRPRFfG9bMjfOP9Wasj1/GwtHAwCA15Hva8qxtUmR1Yffq7kr+x8+5f8qO+YXDwLnX8rpMMuXVOW98E+urzfsn7N4NAAA2AH5fq7qklPJZ6evTWvZ/jpfU+9vn23+ePUhLay1eDQAAHi93mw2Sx93pNfrpU+FnR8fOuc4K4VLAbR0rlKoxdDSlUqh/R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAOiyh8ter3d2M02LS22yTdqqd/mQFqGj5HsAgHcwvTnLnyda1j6FwDryPQAAxCHfAwC8g8mf8cnJ6fVk1vB41U/fwwvJ9wAAEId8DwB0Qjn8NVnWTb3eoX2DbuyN/u/PHy//ptq0vtWK4jwN562fY+nA3U8fNNeza/I9AHDw8sR8cZcWcuPRt2Yin9ycDUbjtJB/P1g1EU6eu+ub59uf/fidFlp+XTY2zSwpzmAxv7eKdHfR2GT695nTwSvJ9wDAYcvCeBmmh/epk/psNrn+VHyXjEcXo5OqK/vk+jRfd/ej+QTwZHrzrcjdtc7v2T7jcTPEJ+PR6K46cdk5/uGyKE6tNPfDbLl1vqVF+tl+BshC/5yZOdkN+R4AOGgP/+RhPM/it+dp1clJ/+q2ORB1eD8fmdq/+reI0+M/k3JFy/yAtbGs/avHIqQvkW1YO3H2cPAjS/dZuK+tPL/Ndx7/96se8OsnqIpUC/jF8NqGPOsv6ycE25HvAYBDVvZjGX5vxvm24ZdaBD/pf2i07jeVBzz9+rl1wPMvSwN+e8Myl9fb3XNFi37zgaLZtX6hSOe3ZdN+pXy8WOh3BFuT7wGAQ7bYzr3E6cdB+rReecC9D2zdpki5LO8XEb/1KwBsTb4HANhWrfN9Tb0fzwsMPha99OF15HsA4JCVoff5wbJbSwdcGOr68LM+I86zyt1//91DI/sb/bJAdPL9Sk/z1z7raW7c0ga7ZIqtjJMHgLX6V9+LbiujQf32Or25fGng73/+WgT8xnSV2Z25MeHl88rdW8XJ919791+tKkFzJAFsT74/QuXDhacLADqinJ2myNTFHSw3GL189vhqMpv6INksWg+HS8fXLphPz1MrzqYPB0/qb74qFEdozdUDLyHfv1b/6nFWzYfbCeW0XgDQIflcM2kK+aQ2HeYL5HfvxnSYxeybX9LCWvnuzeLk/fG3K1D6FaEm79LfoUDB4epl2TR93JHsATR9Kuz8+G+q+KmsOT/uOpvtUv4G15w7901Mn16l9w5nP1ahKsXGjvNPDSt0rlKoxdDSlUqh/f6olO/r2/T3RwAAOke+L6Uu6aVl42PqveQa37fH1y7V6GP3/OHzb6pN61utKF3xVbGqfo7lXetTur/f/PdHAAA6Rr4vI3JjVMzCq+MmT51acuPRYIuxqXnuru9djLj/8cygoF+XjU0zS0o3WMzvrRI2pwQozdO9PjkAAHEdfb7P0neZnmvvqZhcN94gPR5djE6uJ9V35YD7TWfhLVN1OW4nyQ4xHjdDfDIeje6qcpT99x8ui9LVCleMBmqdfmkJm9P6SvcAAEfh2PP9wz95+i4GzT8F3/7VbXNwbG2Mfr+aE+vPpFyx2vz4teG2/avHxpD9mmzDegAvp7ppjoMt5whrvbu6foKqhPWA/1D8LCDdAwCEd+T5fvo37ycz/N6M823NF030PzRa91cqj3/69XPr+Odflgb89obla+xqk/MWihb95vNF8013rRKWP1G0Hh0AAAjpyPN9GaDXOP04SJ+29kbvmV5VwqrpfvV8nQAAxGB87eGrdb6v2awxvnqZVfM3gHLEQVrnNbYAAIEceb4ffCx6qm86WHZr6fjNoa6Zh59Fwl6n3P333z2VDgCAcI483/evvucd4fMZK2sRf3pzuaPAn9493Zyu8qF4d+0myt1bpcv3b86Bv0L+Au1F5fDe9LuAXvkAAIEcff+ccjqaIkQXvVVyg9Ezs9Nvr5rMpt5BJgv3m75Bdj5bT610mz4cAABwhPS/zxL+fM74ZKeDUfMW9MZ0mMVknBu/QTbfvVm6vN3dYFkAAJbqzWaz9HFHer1e+lTY+fGhc46zUrgUQEvnKoVaDC1dqRTa7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOKQ7wEAIA75HgAA4pDvAQAgDvkeAADikO8BACAO+R4AAOLozWaz9HFHer1e+lTY+fGhc46zUrgUQEvnKoVazIFr/RV9F4dZL+R72LvjrBQuBdDSuUqhFh+s1v+ao/X2fye7Uinke9i746wUbj8HyAX5fXXuUnCABXZhKanL76UrtVi+h707zkrhUnCAZKODcviV4gD/wriS8L66cmuT72HvjrNSuBRAS+cqhVoMLV2pFObPAQCAOOR7AACIQ74HAIA45HsAAIhDvgcAgDjkewAAiEO+BwCAOOR7AACIQ74HAIA45HsAAIhDvgcAgDjkewAAiEO+B3jGw2Wv1zu7mabFZaY3Z41tNtglU2zVu3xIi8CRcpFhP+R7gPjKm33FTR/Yh/JhJFn7EML+yPcAL9e/epzNZo9X/bR8iPI77sVdWijcXcj40BFduMgU8laEwWicljLj0TcJ/73I9wDhnV5PsoSQ3A/zVXc/3HmBHZnenJWtCMP7dKGpLjW8C/keILb+1WOj7e/8trjtjv9MymWAV5nefMsb7vNsf3ue1uWXmg786hCVfA/Q6J2+rM9ovVNp4/v20Lel1nZJfTpKtWl9qxWlK74qVtXPsa7rzfTv7+yfpx8H5SJ01IsrTqZeY96it1roi8z0139Zuj+9/t9TtuedyffAccvvXo3e6Qt9Ric3Z/VOpePRYIs0kN8SW11SB2c/8ny9xK/LxqaZJaUbLIaRVgnvLlbllYfyJMPvWtYIYtuKs1Ar7y62qNPbi36RSfH+6+d+/RFg2VMGb0a+B45Ydjcqb2y1PqOT60/Fd8l4dDE6qbqvT65P83Ub911Pv1rX+79nhxiPm/fXZDwa3VXlKH/WfrgsStfu0No6/dIS/mzcnvM7eCU7ZOtXdOiyrStOGUcXvn5ePbUuWpNjj+AiM/mTnez064df7YcUGf8dlf+zdigdt5LWwhFLlaGS1kaX/rSVtPbAlHf1xuDTunTTr9355re2al25+HSEYpf54jPHXzhuOmhrw3Jt4+yZxhmWnaBVwkI645OFMvEG0n/8Slp7wFJBK2nt4XhhxSk3eKM6sKyO1qSq2Shtqwq3i1v7k1RLi8dfOO4L/1stP0GrhOlkja3SJgvH7rziT/UkrT082u+Bo1X2Q1/XUWX4pd7S3f/QaHhbKfVz//q5dfzzL9XtsKG9YdEoVsxlWVc0tjXHxn76UN9vWQnPb9M1P1Pcd/Mf8LWsEcLWFaf/+WtZB7LVe+2XkzmGi0xZhjzK14bT9q8ei9jf+imRtyLfA0ervLet8YphqOXxmzfGPdiyhPls2vmNdzz6x42Xo5TXgdS+XEbb/aX8Y7jIpLTffEjJDD7m/4l//9WQ8B7ke4BDtvzn7Vf2nnfjJbp1Fad8a1TqW9IYLbroVf3vO2AvFxnel3wPHK0y5W48jm1r6fgLv08//CyG262zxxD+Ro1+8A62qzjnt2VL/qrtq2eB5VbO8X4UF5myM1C7EGkYs8vM+5DvgaPVv/qe35ZafdGnN5c7uheX3XxbbYMPl8256J437yXcaB/M9t+qvTBvemw2TVYlWPg5HSJYW3EeLhvfbNSF5qWO4iJTBfx6IdI8vObEfy/yPXDE0qtc8/tb+q291xuMysFiO9C/+rfeybeQ3XeHw+Kka1W710u36X27oXb6THGE0+uJn9+JaX3FWfxmf++DOIqLTPUryFMh0mXm3339Z2UN+R44avnMMtVMbqXGJBCvVQ1mncsnkLv9khbWqo0DrAzvV/cHaMsO0TpC0dt2h39GODSrK04VRit5hdjn0274i0xuaSlcZt5Pb7Ywl+crZU9t6VNh58eHzjnOSuFSAC2dqxRqMbR0pVJovwcAgDjkewAAiEO+BwCAOOR7AACIQ74HAIA45HsAAIhDvgcAgDjkewAAiEO+BwCAOOR7AACIQ74HAIA4erPZLH3ckV6vlz4Vdn586JzjrBSLf+qvX7+mhcJ///2XPkFc87/22V/4zl0K3NChpSuVQvs98HayiFNKy3AE/J0H3ph8D7yPHhyB9Ncd4A3pnwN7d5yVwqUAWjpXKdRiaOlKpdB+DwAAccj3AAAQh3wPAABxyPcAABCHfA+wjYfLXq93djNNi8tMb84a22ywS6bYqnf5kBYB4GXke4CjVz6RPMtDB0CXyPcAO9a/epzNZo9X/bQMAG9Ivgc4euUTyYLJ9Wn25fD+9rzcDIAukO8BWGZ68200lu4BOke+B1iqHO+aLBsdW++03vi+Pb52qUaX9+cPn39TbVrfakXpnobz1s+xdR/6h3+ydH96/T/pHqBj5HuABXlEvrhLC7nx6Fszgk9uzgZZ/q2MR4MtAnSeu+t757uf/fidFlp+XTY2zSwp3WAxv7dKeHexVcR/uMzOcHr9r0EEAJ0j3wM0Zem7TM/D+9QPPe+J/qn4LhmPLkYn15Pqu7yX+sndj+YTwLPKfi8nWXpOBygOMR43Q3wyHo3uqnKUI3aL5N0o3P0wW26dfmkJf24a8Kc3P7JzDL9L9wAdJN8DNBT9UorwXet43r+6bWbd4f18fpz+1b9Ffh7/mZQrVpsfvzbBTv/qsQjpS2Qb1jvAp+R9Xy/c+W2+8/i/X/WAXz9BVcJNA76uOQBdJt8D1E3/5v1k1jVdD7/Us2//Q6N1f6Xy+KdfP7eOf/5lacBvbzj5kzfz312kXvVJ0aLffL749KG+31Yl1HgP0GnyPUBdGaDXOP04SJ+2Vh6/mb734OUlLH9faD7AANAh8j1A59Q639fsZCLLh593eecefXMAOku+B6gbfCx6qm86WHZr6fgLPeGLXL1eufvvv3sqXdk3Z7H3EADdId8D1PWvvucd4fMZK2sRf3pzuaPA3//8tQj4jekqHy6bE14+r9y9Vbp8/+Yc+C80/fVfPvZXvAfoMvkeoKmcjqYI0Wn4aq83GD0zO/32qsls6oNks3A/HD4zgU7LfLaeWuk2fThY640GBwCwT/I9QNv57XzO+KQ2Hebr9a8eyznrK8VknF/Swlr57s3S5f3xd1G+NHeQobUAndabzWbp4470er30qbDz40PnHGelcCmAls5VCrUYWrpSKbTfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAcvdlslj7uSK/XS58KOz8+dM5xVgqXAmjpXKVoFRhoOdharP0eAADi0H4Pe6f9Hlik/R66Tvs9AACwd/I9AADEsff+OUCL/jlA5kguBcDb034PAABxaL+Ht6bRDgDYH+33AAAQh3wPAABx7L5/DgAA8F603wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAMQh3wMAQBzyPQAAxCHfAwBAHPI9AADEId8DAEAc8j0AAERxcvL/G2vYZzDnMQUAAAAASUVORK5CYII="},602:function(s,t,n){"use strict";n.r(t);var a=n(1),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"javascript-为什么需要-event-loop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#javascript-为什么需要-event-loop"}},[s._v("#")]),s._v(" javascript 为什么需要 event loop?")]),s._v(" "),a("p",[s._v("在回答这个问题之前，我们应该要知道 javascript 是一个单线程的解释性语言。")]),s._v(" "),a("p",[s._v("为什么 javascript 是单线程语言？\n主要因为 JavaScript 作为浏览器的脚本语言，主要用途是与用户交互，以及操作 DOM 元素，这就决定它在同一时刻只能执行一种操作。")]),s._v(" "),a("p",[s._v("如果像其他编程语言一样允许多线程，则很容易出现线程安全问题。不过也有新的方案使 javascript 支持多线程，例如："),a("code",[s._v("WebWorker")]),s._v("，但是它是有条件的多线程。")]),s._v(" "),a("p",[s._v("再回到最初的问题，为什么需要 event loop，主要由于 js 是单线程的，容易出现阻塞导致出现一种卡顿现象。但是又不能简单粗暴地使用多线程，为了充分利用 CPU 的计算能力，当充分阻塞 I/O 时，可以将其挂起，等到出结果再去直线，于是就有了任务的概念。")]),s._v(" "),a("p",[s._v("在 js 中，任务分为两种：")]),s._v(" "),a("ul",[a("li",[s._v("同步任务。\n同步任务指的是在主线程运行的任务，只有前一个任务执行完毕，才能继续执行下一个任务。")]),s._v(" "),a("li",[s._v("异步任务。\n异步任务指的是不进入主线程而是进入“任务队列”执行的任务。异步任务不会阻塞同步任务的执行。")])]),s._v(" "),a("ol",[a("li",[s._v("所有的同步任务都在主线程上执行，形成一个执行栈(executing context)。")]),s._v(" "),a("li",[s._v("主线程之外，还有一个“任务队列”，用于存放异步任务。只要异步任务执行有了结果就在任务队列中放置一个事件。")]),s._v(" "),a("li",[s._v("一旦执行栈中的任务完成，系统就会去读取”任务队列“，并查看有没有待执行的事件。对应的那些异步任务将会停止等待，放入到执行栈中，等待执行。")]),s._v(" "),a("li",[s._v("主线程不断地重复执行上述 3 个步骤。")])]),s._v(" "),a("p",[s._v("具体的过程可以参看如下图：")]),s._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{width:"80%"},attrs:{src:n(537),alt:"img"}})]),s._v(" "),a("center",[s._v("（图片来源：阮一峰 - JavaScript 运行机制详解：再谈Event Loop）")]),s._v(" "),a("p",[s._v("通过图我们可以看到，只有主线程上没有任务，主线程才会去查看任务队列（值得一提的是在 js 中每一次的事件循环称之为一帧"),a("code",[s._v("tick")]),s._v("）。")]),s._v(" "),a("h2",{attrs:{id:"事件循环"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事件循环"}},[s._v("#")]),s._v(" 事件循环")]),s._v(" "),a("p",[s._v("事件循环指的是主线程从任务队列中读取事件，执行实现，不断往复的过程。")]),s._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{width:"80%"},attrs:{src:n(538),alt:"img"}})]),s._v(" "),a("center",[s._v("（图片来源：js 中的宏任务与微任务）")]),s._v(" "),a("h2",{attrs:{id:"宏任务与微任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#宏任务与微任务"}},[s._v("#")]),s._v(" 宏任务与微任务")]),s._v(" "),a("h3",{attrs:{id:"宏任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#宏任务"}},[s._v("#")]),s._v(" 宏任务")]),s._v(" "),a("p",[s._v("我们上面所说的任务队列就是一个宏任务。浏览器为了让任务队列（宏任务）的执行与 DOM 渲染能够有序执行，会在在下个宏任务执行之前对页面重新渲染。即")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("宏任务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("渲染"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("宏任务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("渲染"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("常见的宏任务有：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("整体代码"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsetTimeout\nsetInterval\nI/O"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nUI交互事件。click, mouseenter, "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\npostMessage\nMessageChannel\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# setImmediate(node)")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"微任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微任务"}},[s._v("#")]),s._v(" 微任务")]),s._v(" "),a("p",[s._v("宏任务能够保证任务队列的执行与 DOM 渲染能有序执行。但是在某些场景下，我们执行的异步代码又不需要保证 DOM 渲染有序执行，甚至没有对 DOM 进行操作。但是执行完一个宏任务会对页面进行一次渲染，这样会影响性能，对于某些场景，我们可以忽略渲染过程，直接执行异步代码，这就是微任务的作用。")]),s._v(" "),a("p",[s._v("微任务会在执行栈中为空，或者执行完一个宏任务后进行微任务队列里面"),a("strong",[s._v("所有的")]),s._v("任务。\n常见的微任务有：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("Promise.then\nObject.observe\nMutationObserver\nprocess.nextTick"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"nodejs-中的任务队列"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nodejs-中的任务队列"}},[s._v("#")]),s._v(" nodejs 中的任务队列")]),s._v(" "),a("p",[s._v("nodejs(js)中无法实现"),a("code",[s._v("first-in-first-handle")]),s._v("或"),a("code",[s._v("first-finish-first-handle")]),s._v("的异步处理机制。这是由于异步任务中可能还嵌套着其他异步任务。如果按照以上的其中一种规则执行，这就意味着，需要把当前的异步任务完全执行完毕（包括嵌套的异步任务），才能执行下一个任务队列中下一个异步任务。出于多种情况考虑，最好在执行之前先制定好规则。")]),s._v(" "),a("h3",{attrs:{id:"调用栈-事件循环和事件队列-the-call-stack-event-loop-and-callback-queues"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调用栈-事件循环和事件队列-the-call-stack-event-loop-and-callback-queues"}},[s._v("#")]),s._v(" 调用栈，事件循环和事件队列(the call stack, event loop and callback queues)")]),s._v(" "),a("blockquote",[a("p",[s._v("调用栈：当执行一个函数时，会将函数的上下文（包括局部变量等）推入一个栈中。\n事件队列保留异步操作需要执行的回调函数。和普通的队列一样也是先进先出。")])]),s._v(" "),a("h4",{attrs:{id:"回调队列的类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#回调队列的类型"}},[s._v("#")]),s._v(" 回调队列的类型")]),s._v(" "),a("ul",[a("li",[s._v("Micro task queue")]),s._v(" "),a("li",[s._v("Timer queue")]),s._v(" "),a("li",[s._v("IO queue")]),s._v(" "),a("li",[s._v("Check queue (also known as immediate queue)")]),s._v(" "),a("li",[s._v("Close queue")])]),s._v(" "),a("h5",{attrs:{id:"io-queue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#io-queue"}},[s._v("#")]),s._v(" IO queue")]),s._v(" "),a("p",[s._v("由于 js 无法直接进行 IO 操作，对于 IO 操作 js 会转交给 nodejs 进行处理。\n处理完成后，它们会被转移到 IO 回调队列中，进行事件循环，以转移到执行栈中执行。")]),s._v(" "),a("h5",{attrs:{id:"timer-queue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#timer-queue"}},[s._v("#")]),s._v(" Timer queue")]),s._v(" "),a("p",[s._v("涉及到定时器的操作都需要被添加到 Timer queue 中，所有的定时器操作都是异步的。js 会将时间相关的操作转交到 nodejs 执行，完成后将其添加到定时器队列中。(可以参考: "),a("a",{attrs:{href:"https://dillionmegida.com/p/browser-apis-and-javascript/#javascript-on-nodejs",target:"_blank",rel:"noopener noreferrer"}},[s._v("Some Javascript features are actually Browser APIs"),a("OutboundLink")],1),s._v(")")]),s._v(" "),a("h5",{attrs:{id:"micro-task-queue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#micro-task-queue"}},[s._v("#")]),s._v(" micro-task queue")]),s._v(" "),a("p",[s._v("微任务队列分为两种：")]),s._v(" "),a("ul",[a("li",[s._v("由"),a("code",[s._v("process.nextTick")]),s._v("而延时的函数")]),s._v(" "),a("li",[s._v("由"),a("code",[s._v("promises")]),s._v("而延时的函数。例如 pending，callback 待定的回调。")])]),s._v(" "),a("p",[a("code",[s._v("process.nextTick")]),s._v("是一个（"),a("code",[s._v("tick")]),s._v("，即下一次事件循环）执行的函数。微任务对队列需要存放此函数，以便在下一帧时执行微任务。\n这意味着事件循环会在每一次执行其他队列之前，去检查微任务队列中是否有此类函数。"),a("strong",[s._v("说明微任务的优先级要高于其他任务")]),s._v("。")]),s._v(" "),a("p",[a("code",[s._v("promise")]),s._v("的初始变量会存储在 js 的内存中。nodejs 会将"),a("code",[s._v("promise")]),s._v('的"回调函数"(then 传入的函数，或者 catch 等传入的函数)放入微任务队列中，同时用得到的结果来更新 js 内存中的变量。')]),s._v(" "),a("h5",{attrs:{id:"check-queue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#check-queue"}},[s._v("#")]),s._v(" check queue")]),s._v(" "),a("p",[s._v("check queue 也叫 immediate queue。当 IO queue 中的所有回调函数执行完毕后，立刻执行该队列中的回调函数。用"),a("code",[s._v("setImmediate")]),s._v("可以往该队列中添加回调函数。（！！有待验证）")]),s._v(" "),a("h5",{attrs:{id:"close-queue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#close-queue"}},[s._v("#")]),s._v(" close queue")]),s._v(" "),a("p",[s._v("存放关闭操作的回调函数。例如："),a("code",[s._v("http close event")]),s._v("，"),a("code",[s._v("stream close event")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"执行顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#执行顺序"}},[s._v("#")]),s._v(" 执行顺序")]),s._v(" "),a("ol",[a("li",[s._v("micro-task queue")]),s._v(" "),a("li",[s._v("timer queue")]),s._v(" "),a("li",[s._v("I/O queue")]),s._v(" "),a("li",[s._v("check queue")]),s._v(" "),a("li",[s._v("close queue")])]),s._v(" "),a("h2",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),a("h3",{attrs:{id:"示例-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例-1"}},[s._v("#")]),s._v(" 示例 1")]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// event loop: micro-task, macro-task and task")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'main: 1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'macro-task: 1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'micro-task: 1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'macro-task: 2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'micro-task: 2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'main: 2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * main: 1\n * main: 2\n * micro-task: 1\n * micro-task: 2\n * macro-task: 1\n * macro-task: 2\n */")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("从上面示例可以验证：js 会先执行主线程的任务，只有当主线程任务执行完毕后，才会去查看任务队列（宏任务，微任务）中是否有任务需要执行。并且微任务的优先级要宏任务。")]),s._v(" "),a("h3",{attrs:{id:"示例-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例-2"}},[s._v("#")]),s._v(" 示例 2")]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("async1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'async1 start'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("async2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'async1 end'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("async2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'async2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'script start'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'setTimeout'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("async1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Promise")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resolve "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'promise1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'promise2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'script end'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("具体的执行过程如下：\n"),a("img",{attrs:{src:n(539),alt:""}}),s._v("\n里面需要注意的点是"),a("code",[s._v("await")]),s._v("。"),a("code",[s._v("await xxx() == new Promise(resolve => {xxx(); resolve();})")]),s._v("\n这就是为什么先输出"),a("code",[s._v("async2")]),s._v("然后才输出"),a("code",[s._v("promise1")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"示例-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例-3"}},[s._v("#")]),s._v(" 示例 3")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'start'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'children2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'children3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("resolve")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'children 4'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'children 5'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'children 6'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("res")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'children 7'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// start")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// children 4")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// children 2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// children 3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// children 5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// children 7")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// children 6")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("p",[s._v("执行过程如下：\n"),a("img",{attrs:{src:n(540),alt:""}}),s._v("\n主线程执行，输出"),a("code",[s._v("start")]),s._v("（line 1），遇到宏任务/微任务（line 2-7，line 11-20），则放入对应的任务队列中。"),a("code",[s._v("new Promise")]),s._v("中的同步代码属于主线程的执行代码，所以输出"),a("code",[s._v("children4")]),s._v("（line 10），然后开始执行任务队列中的代码。")]),s._v(" "),a("p",[s._v("一开始微任务队列中没有任务，所以开始执行宏任务（line 3-6）。输出"),a("code",[s._v("children2")]),s._v("，同时将一个微任务推入微任务队列中。为什么之后就输出"),a("code",[s._v("children3")]),s._v("？我们来看对应的宏任务回调的代码：")]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'children2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'children3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("由于在执行该宏任务的时候，会将"),a("code",[s._v("children3")]),s._v("推进微任务任务队列中，而宏任务执行结束，系统回去清空微任务队列，于是输出"),a("code",[s._v("children3")]),s._v("。")]),s._v(" "),a("p",[s._v("接着继续执行下一个宏任务（line11 - 14），也就是第二个定时器。输出"),a("code",[s._v("children 5")]),s._v("。同时"),a("code",[s._v("resolve('children 6')")]),s._v("将"),a("code",[s._v("premise")]),s._v("中的回调推入微任务队列中。\n执行完宏任务后，当前宏任务队列已经为空，开始清空微任务队列。于是输出"),a("code",[s._v("children 7")]),s._v("。同时又创建了一个宏任务（line 17-19），执行完微任务，继续执行宏任务输出"),a("code",[s._v("res = children 6")]),s._v("。至此，任务队列为空，所有的任务执行完毕。")]),s._v(" "),a("h3",{attrs:{id:"示例-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例-4"}},[s._v("#")]),s._v(" 示例 4")]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Promise")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resolve "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" p1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Promise")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resolve "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    p1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'end'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// end")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 4")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("h2",{attrs:{id:"reference"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[s._v("#")]),s._v(" reference")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2014/10/event-loop.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("JavaScript 运行机制详解：再谈 Event Loop"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/78113300",target:"_blank",rel:"noopener noreferrer"}},[s._v("js 中的宏任务与微任务"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.html.cn/web/node-js/20035.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("深入了解 Node.js 的队列"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://dillionmegida.com/p/browser-apis-and-javascript/#javascript-on-nodejs",target:"_blank",rel:"noopener noreferrer"}},[s._v("Some Javascript features are actually Browser APIs"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://vimeo.com/96425312",target:"_blank",rel:"noopener noreferrer"}},[s._v("《Help, I'm stuck in an event-loop》"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://blog.logrocket.com/a-deep-dive-into-queues-in-node-js/",target:"_blank",rel:"noopener noreferrer"}},[s._v("A deep dive into queues in Node.js"),a("OutboundLink")],1)])])],1)}),[],!1,null,null,null);t.default=e.exports}}]);